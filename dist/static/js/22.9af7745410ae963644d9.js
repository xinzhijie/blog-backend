webpackJsonp([22],{"3/Dp":function(t,a){},Ngfx:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-dialog",{attrs:{title:t.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(a){t.visible=a}}},[e("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"120px"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.dataFormSubmit()}}},[e("el-form-item",{attrs:{label:"链接名称",prop:"title"}},[e("el-input",{attrs:{placeholder:"链接名称"},model:{value:t.dataForm.title,callback:function(a){t.$set(t.dataForm,"title",a)},expression:"dataForm.title"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"链接地址",prop:"url"}},[e("el-input",{attrs:{placeholder:"链接地址"},model:{value:t.dataForm.url,callback:function(a){t.$set(t.dataForm,"url",a)},expression:"dataForm.url"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.url,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?e("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.visible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",disabled:t.confirmButtonDisabled},on:{click:function(a){return t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},staticRenderFns:[]};var i=e("VU/8")({data:function(){return{visible:!1,confirmButtonDisabled:!1,dataForm:{avatar:""},dataRule:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],title:[{required:!0,message:"链接名称不能为空",trigger:"blur"}],url:[{required:!0,message:"链接地址不符合规范",pattern:"(http|ftp|https):\\/\\/[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\w\\-\\@?^=%&amp;/~\\+#])?",trigger:"blur"}]},imageUrl:"",url:""}},methods:{init:function(t){var a=this;this.dataForm.id=t||"",this.visible=!0,this.confirmButtonDisabled=!1,this.url=this.$http.adornUrl("/admin/oss/resource/upload?token="+this.$cookie.get("token")),this.$nextTick(function(){a.$refs.dataForm.resetFields(),a.dataForm.id?a.$http({url:a.$http.adornUrl("/admin/operation/link/info/"+a.dataForm.id),method:"get",params:a.$http.adornParams()}).then(function(t){var e=t.data;e&&200===e.code&&(a.dataForm=e.link,a.imageUrl=e.link.avatar)}):(a.dataForm={},a.imageUrl="")})},dataFormSubmit:function(){var t=this;this.$refs.dataForm.validate(function(a){a&&t.$http({url:t.$http.adornUrl("/admin/operation/link/"+(t.dataForm.id?"update":"save")),method:t.dataForm.id?"put":"post",data:t.$http.adornData(t.dataForm)}).then(function(a){var e=a.data;t.confirmButtonDisabled=!0,e&&200===e.code?t.$message({message:"操作成功",type:"success",duration:1e3,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):t.$message.error(e.msg)})})},handleAvatarSuccess:function(t){t&&200===t.code&&(this.dataForm.avatar=t.resource.url,this.imageUrl=this.dataForm.avatar,this.$message.success("上传成功！"))},beforeAvatarUpload:function(t){var a="image/jpg"===t.type||"image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type,e=t.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是jpg、png、gif格式!"),e||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&e}}},r,!1,function(t){e("3/Dp")},null,null);a.default=i.exports}});